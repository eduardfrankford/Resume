<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description"
        content="In this article we analyzed whether elon musk tweets can positively or negatively influence the bitcoin price. We found that it can be statistically proven that a positive tweet influences the bitcoin price also positivelly" />
    <meta name="author" content="Eduard Frankford" />
    <title>Can Elon Musk influence the Bitcoin price?</title>
    <!-- Favicon-->
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="/../css/blog.css" rel="stylesheet" />
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date(); a = s.createElement(o),
                m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-115131790-2', 'auto');
        ga('send', 'pageview');
    </script>
    <script data-ad-client="ca-pub-5566590506228701" async
        src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</head>

<body>
    <!-- Responsive navbar-->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="#!">Eduard Frankford's notes</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                    <li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
                    <!-- <li class="nav-item"><a class="nav-link" href="#!">About</a></li>
                    <li class="nav-item"><a class="nav-link" href="#!">Contact</a></li> -->
                    <li class="nav-item"><a class="nav-link active" aria-current="page" href="../blog.html">Blog</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <!-- Page content-->
    <div class="container mt-5">
        <div class="row">
            <div class="col-lg-12">
                <!-- Post content-->
                <article>
                    <!-- Post header-->
                    <header class="mb-4">
                        <!-- Post title-->
                        <h1 class="fw-bolder mb-1">Can Elon Musk influence the bitcoin price?</h1>
                        <!-- Post meta content-->
                        <div class="text-muted fst-italic mb-2">Posted on January, 2022 by Eduard Frankford</div>
                        <!-- Post categories-->
                        <a class="badge bg-secondary text-decoration-none link-light" href="#!">Elon Musk</a>
                        <a class="badge bg-secondary text-decoration-none link-light" href="#!">Bitcoin</a>
                        <a class="badge bg-secondary text-decoration-none link-light" href="#!">Cryptocurrencies</a>

                    </header>
                    <!-- Preview image figure-->
                    <figure class="mb-4"><img class="img-fluid rounded" src="../img/rsz_1bitcoin_chart.jpg"
                            alt="Image of the bitcoin chart" /></figure>
                    <!-- Post content-->
                    <section class="mb-5">
                        <h2 class="fw-bolder mb-4 mt-5">Goal:</h2>
                        <p class="fs-5 mb-4">Everytime Elon Musk posts something positive or negative about bitcoin or
                            some other
                            crypto-currencies, then the price goes up or down. That's what many people think when they
                            take a look at the bitcoin price after Musk posts something on Twitter. The goal of this
                            article is to statistically analyze the correlation between Elon Musk tweets and price
                            increase or decrease of a Bitcoin. </p>

                        <h2 class="fw-bolder mb-4 mt-5">Research questions:</h2>
                        <p class="fs-5 mb-4">
                        <ul class="fs-5 mb-4">
                            <li> Can a significant Bitcoin price difference be found after an Elon Musk has
                                posted a tweet about Bitcoin?</li>
                            <li>If yes, is it possible to predict whether this price increase will be positive or
                                negative?</li>
                            <li>If yes, is it possible to automate tweet sentiment analysis to create a trading bot that
                                can yield a positive return on investment?</li>
                        </ul>
                        </p>
                        <h2 class="fw-bolder mb-4 mt-5">Datasets used (all from Kaggle)</h2>
                        <p class="fs-5 mb-4">
                            If you want to replicate our results at home you will need the following datasets:
                        <ul class="fs-5 mb-4">
                            <li> <a href="https://www.kaggle.com/aipeli/btcusdt">Bitcoin price history of the current
                                    year</a></li>
                            <li><a href="https://www.kaggle.com/mczielinski/bitcoin-historical-data">2012 to 03-2021 |
                                    historical</a></li>
                            <li><a href="https://www.kaggle.com/andradaolteanu/all-elon-musks-tweets">Tweets of Elon
                                    Musk</a></li>
                            <li><a href="https://www.kaggle.com/kaushiksuresh147/bitcoin-tweets">All bitcoin tweets</a>
                            </li>
                        </ul>
                        </p>

                        <h2 class="fw-bolder mb-4 mt-5">Import libraries</h2>
                        <p class="fs-5 mb-4">
                        <pre style="background-color: lightgray;"><code>
    import datetime
    import os
    import pandas as pd
    import re
    import numpy as np
    from vaderSentiment.vaderSentiment import SentimentIntensityAnalyzer

    def data_file(f):
        return os.path.join("..", "data", f)

    def clean_data_file(f):
        return os.path.join("..", "data", "cleaned", f)</code></pre>
                        </p>

                        <h2 class="fw-bolder mb-4 mt-5">Read Musk dataset</h2>
                        <p class="fs-5 mb-4">
                        <pre style="background-color: lightgray;"><code>
    musk = pd.read_csv(data_file("TweetsElonMusk.csv"))
                        </code></pre>

                        <p class="fs-5 mb-4">
                            Select the needed columns:
                        </p>
                        <pre style="background-color: lightgray;"><code>
    musk = musk[["created_at", "tweet", "replies_count", "retweets_count", "likes_count"]]</code></pre>

                        <p class="fs-5 mb-4">
                            Lets have a look at the loaded data:
                        </p>
                        <pre style="background-color: lightgray;"><code>
    musk.head()</code></pre>

                        <figure class="mb-4" style="padding: 2%;"><img class="img-fluid rounded"
                                src="../img/head_output1.png" alt="Picture of the output of the first head statement"
                                width="600" /></figure>

                        <p class="fs-5 mb-4">
                        Now check for invalid values:
                        </p>
                        <pre style="background-color: lightgray;"><code>
    musk.isna().any() </code></pre>

    <p class="fs-5 mb-4">
                        There are no invalid values in our data set used.
                        The next step is to determine the tweets of Elon Musk containing Bitcoin.
                        To do that we will filter all tweets that contain 'bitcoin' or 'btc'.

</p>
                        <pre style="background-color: lightgray;"><code>
    musk_btc = musk[musk["tweet"]
        .str.contains("bitcoin", case=False) | musk["tweet"]
            .str.contains("btc", case=False) ]
                .reset_index(drop = True)</code></pre>

                <p class="fs-5 mb-4">
                        Only two percent of Elons tweets are about bitcoin. So we have 24 tweets left.
                        His first tweet about bitcoin was in 2017 and the last one in our dataset from March 2021.

                        In order to be able to predict whether the bitcoin price will go up or down we need to classify
                        whether it is positive or negative.
                        We tried to do this automatically with Vader sentiment analysis, but we saw that these results
                        are very unreliable as it is really hard for a classifier to assess a short tweet like "You can
                        now buy a Tesla with Bitcoin" or "Toss a bitcoin to your witcher", because to assess something
                        like that a lot of industry knowledge
                        is needed.
                        Therefore, we decided to label the 24 tweets manually.
                        </p>

                        <p class="fs-5 mb-4">
                        The output can be seen in the following graphic:
                        </p>
                        <figure class="mb-4" style="padding: 2%;"><img class="img-fluid rounded"
                                src="../img/musk_output3.png" alt="Picture of the output of the manually labled tweets"
                                width="900" /></figure>

                                <p class="fs-5 mb-4">
                        After we have cleaned most of the data and labeled the sentiment we will save this dataset using
                        the following code and go on with the analysis of the bitcoin prices and how to merge the two
                        datasets.
                        </p>
                        <pre style="background-color: lightgray;"><code>
    # pkl
    musk_pickle = clean_data_file("musk_cleaned.pkl")
    musk_btc.to_pickle(musk_pickle)
    # csv
    musk_csv = clean_data_file("musk_cleaned.csv")
    musk_btc.to_csv(musk_csv)</code></pre>


                        </p>


                        <h2 class="fw-bolder mb-4 mt-5">Prepare bitcoin prices and merge dataset with musk tweets</h2>
                        <p class="fs-5 mb-4">
                            Let's start again with the same routine as always: Import libraries, datasets and do some
                            cleaning.
                        <pre style="background-color: lightgray;"><code>
    import datetime
    import os
    import pandas as pd

    def data_file(f):
        return os.path.join("..", "data", f)

    def clean_data_file(f):
        return os.path.join("..", "data", "cleaned", f) 
    
    datasets = {
        "current_year": ["binance_btcusdt_kline_1m.csv", "bitcoin_current_cleaned"],
        "historic": ["bitstamp.csv", "bitcoin_historic_cleand"]
    }

    current_dataset = "historic"

    bitcoin = pd.read_csv(data_file(datasets[current_dataset][0]))

    # Drop not usable columns
    # h ... highest price
    # l ... lowest price
    # c ...  closing price 

    if current_dataset == "current_year":
        bitcoin.drop(columns=['h', 'l', 'c'], inplace=True)
    else:
        bitcoin = bitcoin[['Timestamp', 'Open', 'Volume_(BTC)']]
    
    #rename columns

    if current_dataset == "current_year":
        bitcoin.rename(columns={'t': 'datetime', 'o': 'opening', 'v': 'volume'}, inplace=True)
    else:
        bitcoin.rename(columns={'Timestamp': 'datetime', 'Open': 'opening', 'Volume_(BTC)': 'volume'}, inplace=True)
    
    bitcoin.dropna(inplace=True)  
    
    #convert datetime to correct datetype

    if current_dataset == "current_year":
        bitcoin['datetime'] = bitcoin['datetime'].apply(pd.to_datetime, unit='ms')
    else:
        bitcoin['datetime'] = bitcoin['datetime'].apply(pd.to_datetime, unit='s')

    #select by appropriate time range (is different regarding tweets or musk tweets)

    if current_dataset == "current_year":
        bitcoin = bitcoin[(bitcoin['datetime'] >= '2021-01-05') & (bitcoin['datetime'] <= '2022-01-11')]
    else:
        bitcoin = bitcoin[(bitcoin['datetime'] >= '2017-10-28') & (bitcoin['datetime'] <= '2021-04-24')]
        
    #store data to file
    # pkl
    bitcoin_pickle = clean_data_file(datasets[current_dataset][1]+".pkl")
    bitcoin.to_pickle(bitcoin_pickle)
    # csv
    bitcoin_csv = clean_data_file(datasets[current_dataset][1]+".csv")
    bitcoin.to_csv(bitcoin_csv)
    </code></pre>
                        </p>

                        <p class="fs-5 mb-4">
                            After we have prepared the data and saved them to the pickle files we will import them again
                            in the following to continue our analysis:
                        <pre style="background-color: lightgray;"><code>
    import datetime
    import os
    import pandas as pd
    import matplotlib.pyplot as plt
    from scipy import stats
    
    
    def data_file(f):
        return os.path.join("..", "data", f)
    
    def clean_data_file(f):
        return os.path.join("..", "data", "cleaned", f)
    
    musk_tweets = pd.read_pickle(clean_data_file("musk_cleaned.pkl"))
    
    bitcoin = pd.read_pickle(clean_data_file("bitcoin_historic_cleand.pkl"))


    </code></pre>


                        </p>

                        <h2 class="fw-bolder mb-4 mt-5">Calculate hourly changes</h2>
                        <p class="fs-5 mb-4">
                            To continue lets calculate the differences in the bitcoin price from one hour to the other.
                            We need this calculation in order to assess whether the bitcoin price fluctuation after Elon
                            Musk posts something is abnormal,
                            because if we dont know how much the bitcoin price changes on average the positive or
                            negative increase after the post could just be a coincidence.
                        <figure class="mb-4" style="padding: 2%;"><img class="img-fluid rounded"
                                src="../img/priceChart2.png"
                                alt="An image showing the bitcoin price change from one hour to the other."
                                width="600" /></figure>
                        </p>

                        <h2 class="fw-bolder mb-4 mt-5">Merge bitcoin price changes with musk tweets</h2>
                        <p class="fs-5 mb-4">
                            The following code snippet shows how we merged the bitcoin hourly price changes with the
                            elon musk tweet dataset.
                            After the merge the resulting dataset includes the tweet and how the price changed one hour
                            after the tweet was posted.


                        <pre style="background-color: lightgray;"><code>
    tweet_changes = []
    musk_tweets['change'] = 0.0
    for index, row in musk_tweets.iterrows():
        between_datetime = bitcoin['datetime']
            .between(row['created_at']
                +datetime.timedelta(minutes=60), row['created_at']
                    +datetime.timedelta(minutes=61))
        #musk_tweets.iloc[index]['change'] = bitcoin[between_datetime].iloc[0]['change']
        tweet_change = {
            'change': bitcoin[between_datetime].iloc[0]['change'],
            'tweet': row['tweet'],
            'score_computed': row['score_computed'],
            'score_manual': row['score_manual']
        }
        tweet_changes += [tweet_change]
    
    musk_tweets['change'] = musk_tweets.apply(lambda y: add_change_to_tweet(y), axis=1)
                            
                            
                                </code></pre>


                        </p>

                        <h2 class="fw-bolder mb-4 mt-5">See how the price changes are distributed</h2>
                        <p class="fs-5 mb-4">
                            To plot how the changes are distributed we used the following code.
                            First we take all the changes of the bitcoin price changes (hourly) and then we add the
                            changes that happened after Musk posted something about bitcoin.

                        <pre style="background-color: lightgray;"><code>
    plt.hist(bitcoin_change60['change'], bins=1000)
    plt.axis(xmin=-1000,xmax=1000)
    for change in tweet_changes:
        plt.axvline(x=change['change'], c='r',  linewidth=1)

    </code></pre>
                        </p>

                        <p class="fs-5 mb-4">
                            In the following figure we can clearly see that normally the bitcoin price changes are
                            normally
                            distributed. However, when Elon Musk posts something positive about Bitcoin normally the
                            price
                            increase is significantly higher and vice versa if he posts something negative.
                            The red bars within the 0 area are price reactions about neutral tweets about bitcoin.

                        <figure class="mb-4" style="padding: 2%;"><img class="img-fluid rounded"
                                src="../img/bitcoinChanges.png"
                                alt="Normal distribution of the bitcoin price changes with the price differences after Elon Musk posted something about Bitcoin"
                                width="600" /></figure>

                        <p class="fs-5 mb-4">

                            To more clearly show my point the following figure shows the price change after a very
                            positive
                            tweet.
                        </p>

                        <figure class="mb-4" style="padding: 2%;"><img class="img-fluid rounded"
                                src="../img/bitcoinChanges2.png"
                                alt="Normal distribution of the bitcoin price changes with the tweet 'Pay by bitcoin capability available outside US later this year'"
                                width="600" /></figure>

                        <p class="fs-5 mb-4">

                            In this figure shown above one can clearly see how big of an outlier the price change after
                            the
                            positive tweet has caused.


                        </p>

                        <h2 class="fw-bolder mb-4 mt-5">Validate hypotheses with T-test</h2>
                        <p class="fs-5 mb-4">
                            Till now all our conclusion were made with our gut feeling after doing some graphical
                            analysis, but to be 100% sure we have to
                            statistically validate our findings.
                            To do that we save all the changes after Elon Musks tweets into a list and then compare this
                            set of changes with all the hourly changes since bitcoin was created.

                        <pre style="background-color: lightgray;"><code>
    changes = [item['change'] for item in tweet_changes]

    stats.ttest_ind(changes, bitcoin_change60['change'])


    </code></pre>
                        <p class="fs-5 mb-4">

                            After executing the code shown above we get a p-value of 0.047.
                            That means we can reject our null hypothesis which is that there is no significant price
                            change
                            after Elon Musk posts about Bitcoin.
                            As we can reject this null hypothesis we can accept the alternative which means that there
                            is a
                            significant price change after Musk posts something about Bitcoin.

                            So we have learned that there is an abnormal difference, but can we predict whether this
                            difference will be positive or negative?
                            As this would be the most interesting thing to know for an investor.
                            To analyze this we have to seperate the postive tweets and the negative tweets and then
                            again
                            execute the t-tests.
                        </p>

                        <pre style="background-color: lightgray;"><code>
    positive_score = list(filter(lambda x: x['score_manual'] > 0, tweet_changes))
    negative_score = list(filter(lambda x: x['score_manual'] < 0, tweet_changes))
    list_positive_score = [item['change'] for item in positive_score]
    list_negative_score = [item['change'] for item in negative_score]
    </code></pre>

                        <p class="fs-5 mb-4">


                            To plot the results we used the following function:

                        </p>
                        <pre style="background-color: lightgray;"><code>
    def plot_all(change_list):
    plt.hist(bitcoin_change60['change'], bins=1000)
    plt.axis(xmin=-1000,xmax=1000)
    for cl in change_list:
        plt.axvline(x=cl['change'], c='r',  linewidth=1)  

    plot_all(positive_score)
    
    </code></pre>
                        <p class="fs-5 mb-4">

                            The following figure shows all the price changes after Elon Musk posted something positive
                            about
                            Bitcoin and the next figure shows the Bitcoin price changes after a negative tweets.

                        </p>
                        <figure class="mb-4" style="padding: 2%;"><img class="img-fluid rounded"
                                src="../img/positiveChanges.png"
                                alt="Normal distribution of the bitcoin price changes with the price changes after Elon Musk posted something positive about Bitcoin"
                                width="600" /></figure>

                        <figure class="mb-4" style="padding: 2%;"><img class="img-fluid rounded"
                                src="../img/negativeChanges.png"
                                alt="Normal distribution of the bitcoin price changes with the price changes after Elon Musk posted something negative about Bitcoin"
                                width="600" /></figure>
                        <p class="fs-5 mb-4">

                            The last two figures showed us that it might be possible to predict whether the price will
                            increase after a positive tweet and decrease after a negative tweet.
                            To be sure we have to use our t-tests again.
                        </p>
                        <pre style="background-color: lightgray;"><code>
        print(stats.ttest_ind(list_positive_score, bitcoin_change60['change'], alternative='greater'))
        print(stats.ttest_ind(list_negative_score, bitcoin_change60['change'], alternative='less'))
        </code></pre>
                        <p class="fs-5 mb-4">

                            This tests result in p values of 0.0012 for the positive tweets and 0.0083 for the negative
                            tweets.
                            Which again allows us to say that we can predict that the change will be positive after a
                            positive tweet and negative after a negative tweet.
                        </p>

                        <h2 class="fw-bolder mb-4 mt-5">Conclusion and future work</h2>
                        <p class="fs-5 mb-4">
                            Our analysis has shown us that it is possible to predict Bitcoin price changes after an
                            influential person like Elon Musk posts something positive or negative about bitcoin.
                            In order to profit from this insight the next step would be to try to automatize the buying
                            and selling process of Bitcoins after a positive or negative tweet was posted.
                            However, we can not fully automatize this process yet because sentiment analysis is not good
                            enough at the moment. Therefore, we still need a human 'classifier' to tell the system
                            whether
                            the tweet was positive or negative.
                            Future work could consist in doing the same analysis for other crypto-currencies like
                            'Dogecoin' or to try to find the same arbitrage possibilities for other influential persons
                            as Elon Musk does not post about crypto-currencies regularly.
                            We have seen he has only posted 24 times about Bitcoin in the last three years. Therefore,
                            be attentive and check his tweets to be ready to take action if he posts ;-)

                        </p>

                    </section>
                </article>
            </div>
        </div>
    </div>
    <!-- Footer-->
    <footer class="py-5 bg-dark">
        <div class="container">
            <p class="m-0 text-center text-white">Copyright &copy; Eduard Frankford 2021</p>
        </div>
        <div>
            <script data-name="BMC-Widget" data-cfasync="false"
                src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="eduardfrankford"
                data-description="Support me on Buy me a coffee!" data-message="" data-color="#5F7FFF"
                data-position="Right" data-x_margin="18" data-y_margin="18"></script>
        </div>
    </footer>
    <!-- Bootstrap core JS-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Core theme JS-->
    <!-- <script src="js/scripts.js"></script> -->
</body>

</html>